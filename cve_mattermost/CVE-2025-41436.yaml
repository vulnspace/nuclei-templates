id: CVE-2025-41436

info:
  name: Mattermost - Archived Channel Content Exposure via Followed Threads (Version Check)
  author: kellisOne
  severity: low
  description: Mattermost versions < 11.0 fail to properly enforce the "Allow users to view archived channels" setting which allows regular users to access archived channel content and files via the "Open in Channel" functionality from followed threads.
  remediation: Upgrade to Mattermost 11.0.0-alpha.1 or above.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2025-41436
    - https://github.com/advisories/GHSA-x3hx-ch7p-8xgg
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 3.1
    cve-id: CVE-2025-41436
  metadata:
    verified: true
    max-request: 3
  tags: cve,cve2025,mattermost,server,version

http:
  - method: GET
    path:
      - "{{BaseURL}}/api/v4/config/client"
      - "{{BaseURL}}/api/v4/config/client?format=old"
      - "{{BaseURL}}"

    stop-at-first-match: true

    matchers-condition: or
    matchers:
      # Matcher 1: JSON Version (Body) - Vulnerable versions are < 11.0.0-alpha.1
      - type: regex
        part: body
        name: json_vulnerable
        condition: or
        regex:
          - '"Version":"([0-9]+\.[0-9]+\.[0-9]+(-alpha\.[0-9]+)?)"'
        negative: true

      # Matcher 2: Header Version - Check if version is less than 11.0.0
      - type: regex
        part: header
        name: header_vulnerable
        condition: or
        regex:
          - 'X-Version-Id:\s*([0-9]+\.[0-9]+\.[0-9]+)'
        negative: true

    extractors:
      - type: regex
        name: extracted_version_json
        part: body
        group: 1
        regex:
          - '"Version":"([0-9]+\.[0-9]+\.[0-9]+(-alpha\.[0-9]+)?)"'
      
      - type: regex
        name: extracted_version_header
        part: header
        group: 1
        regex:
          - 'X-Version-Id:\s*([0-9]+\.[0-9]+\.[0-9]+)'
